/*!
 * tui-file-uploader.min.js
 * @version 3.1.5
 * @author NHN FE Development Lab <dl_javascript@nhn.com>
 * @license MIT
 */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("tui-code-snippet"),require("jquery")):"function"==typeof define&&define.amd?define(["tui-code-snippet","jquery"],e):"object"==typeof exports?exports.FileUploader=e(require("tui-code-snippet"),require("jquery")):(t.tui=t.tui||{},t.tui.FileUploader=e(t.tui&&t.tui.util,t.$))}(this,function(t,e){return function(t){function e(s){if(i[s])return i[s].exports;var n=i[s]={exports:{},id:s,loaded:!1};return t[s].call(n.exports,n,n.exports,e),n.loaded=!0,n.exports}var i={};return e.m=t,e.c=i,e.p="dist",e(0)}([function(t,e,i){"use strict";var s=i(8);i(13),t.exports=s},function(t,e){"use strict";t.exports.conf={REQUESTER_TYPE_MODERN:"modernRequester",REQUESTER_TYPE_OLD:"oldRequester",FORM_TARGET_NAME:"tuiUploaderHiddenFrame"},t.exports.className={HIDDEN_FILE_INPUT:"tui-js-hidden-file-input",LIST_CONTAINER:"tui-js-file-uploader-list",LIST_ITEMS_CONTAINER:"tui-js-file-uploader-list-items",DROPZONE:"tui-js-file-uploader-dropzone",SUPPORT_DROPZONE:"tui-dropzone-support",DROP_ENABLED:"tui-dropzone-enabled",HAS_ITEMS:"tui-has-items",HAS_SCROLL:"tui-has-scroll",IS_CHECKED:"tui-is-checked"},t.exports.html={FORM:'<form enctype="multipart/form-data" id="tui-uploader-form" method="post"></form>',HIDDEN_INPUT:'<input type="hidden" name="{{name}}" value="{{value}}">',CHECKBOX:['<label class="tui-checkbox">','<span class="tui-ico-check"><input type="checkbox"></span>',"</label>"].join(""),REMOVE_BUTTON:'<button type="button" class="tui-btn-delete">Remove</button>'},t.exports.listTemplate={CONTAINER:'<ul class="tui-upload-lst {{listItemsClassName}}"></ul>',LIST_ITEM:['<li class="tui-upload-item">','<span class="tui-filename-area">','<span class="tui-file-name">{{filename}}</span>','<span class="tui-file-tail"> ({{filesize}})</span>',"</span>","{{removeButton}}","</li>"].join("")},t.exports.tableTemplate={CONTAINER:['<table class="tui-file-uploader-tbl">',"<caption><span>File Uploader List</span></caption>","<colgroup>",'<col width="32">','<col width="156">','<col width="362">','<col width="">',"</colgroup>",'<thead class="tui-form-header">',"<tr>",'<th scope="col" width="32" style="border-right:0;">{{checkbox}}</th>','<th scope="col" width="156">File Type</th>','<th scope="col" width="362">File Name</th>','<th scope="col" width="146" style="border-right:0">File Size</th>',"</tr>","</thead>",'<tbody class="tui-form-body {{listItemsClassName}}"></tbody>',"</table>"].join(""),LIST_ITEM:["<tr>",'<td width="32">','<label class="tui-checkbox">{{checkbox}}</td>','<td width="156">{{filetype}}</td>','<td width="362">','<span class="tui-filename-area">','<span class="tui-file-name">{{filename}}</span>',"</span>","</td>",'<td width="146">{{filesize}}</td>',"</tr>"].join("")}},function(e,i){e.exports=t},function(t,i){t.exports=e},function(t,e){"use strict";function i(t){var e=document.createElement("a");return e.href=t,{href:e.href,host:e.host,port:e.port,hash:e.hash,hostname:e.hostname,pathname:e.pathname,protocol:e.protocol,search:e.search,query:e.search.slice(1)}}function s(t){var e,i,s=["B","KB","MB","GB","TB"];return t=parseInt(t,10),e=Math.log(t)/Math.log(1024)|0,i=(t/Math.pow(1024,e)).toFixed(2),i+" "+s[e]}function n(){return u}function o(t,e){return e=e.replace(/{{([^}]+)}}/g,function(e,i){return t[i]})}function r(){return c}function a(t){var e=i(window.location.href),s=i(t);return s.hostname!==e.hostname||s.port!==e.port||s.protocol!==e.protocol}function h(t,e){for(var i=e.length-1;i>-1;)t===e[i]&&e.splice(i,1),i-=1}function l(t){var e=t.parents("label"),i=e.length;return i?e.eq(0):null}var c=!!(window.File&&window.FileReader&&window.FileList&&window.Blob),u=!!window.FormData;t.exports={getFileSizeWithUnit:s,isSupportFileSystem:r,isSupportFormData:n,template:o,isCrossDomain:a,removeItemFromArray:h,getLabelElement:l}},function(t,e,i){"use strict";var s=i(2),n=i(1),o=s.forEach,r=s.hasStamp,a=s.stamp,h=n.className.HIDDEN_FILE_INPUT,l=s.defineClass({init:function(t){this.planet=t,this.files={}},store:function(t){var e=r(t)&&a(t);e&&(this.files[e]=t)},remove:function(t){var e=this.files[t];return!!e&&(delete this.files[t],!0)},empty:function(){this.files={}},plant:function(){var t=this.planet;o(this.files,function(e,i){e.className=h,e.style.display="none",t.appendChild(e),delete this.files[i]},this)}});t.exports=l},function(t,e,i){"use strict";var s=i(3),n=i(2),o=i(1),r=o.conf.REQUESTER_TYPE_MODERN,a=n.forEach,h=n.defineClass({init:function(t){this.uploader=t,this.formView=t.formView,this.pool=[],t.isBatchTransfer&&(this.remove=this._removeWhenBatch)},TYPE:r,_uploadError:function(t,e,i){this.fire("error",{status:e,message:i})},_uploadSuccess:function(t){this.fire("uploaded",t)},store:function(t){var e=this.pool,i=n.stamp,s=[];t=n.toArray(t||this.formView.$fileInput[0].files),a(t,function(t){var n=i(t);e.push(t),s.push({id:n,name:t.name,size:t.size})}),this.formView.resetFileInput(),this.fire("stored",s)},upload:function(){var t,e=this.formView.$fileInput.attr("name"),i=this.formView.$el.clone();i.find('input[type="file"]').remove(),t=new FormData(i[0]),a(this.pool,function(i){t.append(e,i)}),s.ajax({url:this.uploader.url.send,type:"POST",dataType:"json",data:t,success:s.proxy(this._uploadSuccess,this),error:s.proxy(this._uploadError,this),processData:!1,contentType:!1}),this.clear()},remove:function(t){s.ajax({url:this.uploader.url.remove,dataType:"jsonp",data:t,success:s.proxy(function(t){this.fire("removed",t)},this)})},_removeWhenBatch:function(t){this.pool=n.filter(this.pool,function(e){var i=n.hasStamp(e)?n.stamp(e):e.id;return!t[i]}),this.fire("removed",t)},clear:function(){this.pool.length=0}});n.CustomEvents.mixin(h),t.exports=h},function(t,e,i){"use strict";var s=i(3),n=i(2),o=i(5),r=i(1),a=r.conf.REQUESTER_TYPE_OLD,h=n.defineClass({init:function(t){var e=t.$targetFrame,i=t.formView;this.uploader=t,this.formView=i,this.pool=new o(i.$el[0]),t.isBatchTransfer&&(this.upload=this._uploadWhenBatch,this.remove=this._removeWhenBatch),e.on("load",s.proxy(this._onLoadHiddenFrame,this,e))},TYPE:a,_onLoadHiddenFrame:function(t){var e,i;try{e=t[0].contentWindow.document.body,i=n.pick(e,"firstChild","data"),i&&(this.fire("uploaded",s.parseJSON(i)),e.innerHTML="")}catch(t){this.fire("error",{status:t.name,message:t.message})}},store:function(){var t=this.formView.$fileInput[0],e=n.stamp(t);this.pool.store(t),this.formView.resetFileInput(),this.fire("stored",[{id:e,name:t.value,size:""}])},upload:function(){this.pool.plant(),this.formView.$el.submit(),this.formView.clear(),this.clear()},_uploadWhenBatch:function(){this.pool.plant()},remove:function(t){s.ajax({url:this.uploader.url.remove,dataType:"jsonp",data:t,success:s.proxy(function(t){this.fire("removed",t)},this)})},_removeWhenBatch:function(t){n.forEach(t,function(t,e){this.pool.remove(t,e)},this),this.fire("removed",t)},clear:function(){this.pool.empty()}});n.CustomEvents.mixin(h),t.exports=h},function(t,e,i){"use strict";var s=i(3),n=i(2),o=i(1),r=i(4),a=i(10),h=i(12),l=i(9),c=i(7),u=i(6),d=n.keys,p=n.forEach,f=o.className,m=o.conf.REQUESTER_TYPE_MODERN,_=n.defineClass({init:function(t,e){var i=t.find("."+f.DROPZONE);e=n.extend({usageStatistics:!0},e),this.$container=t,this.url=e.url,this.redirectURL=e.redirectURL,this.formTarget=o.conf.FORM_TARGET_NAME,this.$targetFrame=this._createTargetFrame().appendTo(this.$container),this.isBatchTransfer=!!e.isBatchTransfer,this.isCrossDomain=r.isCrossDomain(this.url.send),this.isSupportPostMessage=!!n.pick(this.$targetFrame,"0","contentWindow","postMessage"),this.isMultiple=!!e.isMultiple,this.useFolder=!!e.useFolder,this.useDropzone=!!i,this.formView=new a(this),this.listView=new h(this.$container.find("."+f.LIST_CONTAINER),e.listUI),this.useDropzone&&!this.useFolder&&r.isSupportFileSystem()&&(this.dragView=new l(i)),this._setRequester(),this._addEvent(),this.isCrossDomain&&this.isSupportPostMessage&&this._setPostMessageEvent(),e.usageStatistics&&n.sendHostname("file-uploader","UA-129987462-1")},_setRequester:function(){r.isSupportFormData()?this._requester=new u(this):this._requester=new c(this)},_setPostMessageEvent:function(){this.$targetFrame.off("load"),s(window).on("message",s.proxy(function(t){var e,i=t.originalEvent;this.url.send.indexOf(i.origin)!==-1&&(e=s.parseJSON(i.data),this.isBatchTransfer?this.clear():this.updateList(e.filelist),this.fire("success",e))},this))},_createTargetFrame:function(){var t=s('<iframe name="'+this.formTarget+'"></iframe>');return t.css({visibility:"hidden",position:"absolute",width:"0px",height:"0px"}),t},_addEvent:function(){this.listView.on({remove:this.removeFile,check:function(t){this.fire("check",t)},checkAll:function(t){this.fire("checkAll",t)}},this),this.isBatchTransfer?this._addEventWhenBatchTransfer():this._addEventWhenNormalTransfer()},_addEventWhenBatchTransfer:function(){this.formView.on({change:this.store,submit:this.submit},this),this._requester.on({removed:function(t){this.updateList(t,"remove"),this.fire("remove",t)},error:function(t){this.fire("error",t)},uploaded:function(t){this.clear(),this.fire("success",t)},stored:function(t){this.updateList(t),this.fire("update",{filelist:t})}},this),this.useDropzone&&this.dragView&&this.dragView.on("drop",this.store,this)},_addEventWhenNormalTransfer:function(){this.formView.on("change",this.sendFile,this),this._requester.on({removed:function(t){this.updateList(t,"remove"),this.fire("remove",t)},error:function(t){this.fire("error",t)},uploaded:function(t){this.updateList(t.filelist),this.fire("success",t)}},this),this.useDropzone&&this.dragView&&this.dragView.on("drop",function(t){this.store(t),this.submit()},this)},updateList:function(t,e){this.listView.update(t,e)},sendFile:function(t){this.store(),this.submit(t)},removeFile:function(t){this.isBatchTransfer||(t={idList:d(t)}),this._requester.remove(t)},submit:function(t){t&&this._requester.TYPE===m&&t.preventDefault(),this._requester.upload()},store:function(t){this._requester.store(t)},clear:function(){this._requester.clear(),this.formView.clear(),this.listView.clear()},getCheckedList:function(){return this.listView.getCheckedItems()},removeList:function(t){var e={};p(t,function(t){e[t.id]=!0}),this.removeFile(e)},getTotalSize:function(t){var e=0;return p(t,function(t){e+=parseFloat(t.size)}),r.getFileSizeWithUnit(e)}});n.CustomEvents.mixin(_),t.exports=_},function(t,e,i){"use strict";var s=i(3),n=i(2),o=i(1),r=o.className.SUPPORT_DROPZONE,a=o.className.DROP_ENABLED,h=n.defineClass({init:function(t){this.$el=t.addClass(r),this._enableClass=a,this._addEvent()},_addEvent:function(){this.$el.on({dragenter:s.proxy(this.onDragEnter,this),dragover:s.proxy(this.onDragOver,this),drop:s.proxy(this.onDrop,this),dragleave:s.proxy(this.onDragLeave,this)})},onDragEnter:function(t){t.preventDefault(),t.stopPropagation(),this._enable()},onDragOver:function(t){t.preventDefault(),t.stopPropagation()},onDragLeave:function(t){t.preventDefault(),t.stopPropagation(),this._disable()},onDrop:function(t){var e=n.pick(t,"originalEvent","dataTransfer","files");return t.preventDefault(),this._disable(),this.fire("drop",e),!1},_enable:function(){this.$el.addClass(this._enableClass)},_disable:function(){this.$el.removeClass(this._enableClass)}});n.CustomEvents.mixin(h),t.exports=h},function(t,e,i){"use strict";var s=i(3),n=i(2),o=i(1),r=i(4),a=r.isSupportFormData(),h=o.className.HIDDEN_FILE_INPUT,l="__fe_id",c=n.defineClass({init:function(t){this._uploader=t,this._html=this._setTemplate(t.template),this.$el=null,this.$fileInput=null,this.$submit=null,a&&(this._isMultiple=t.isMultiple,this._useFolder=t.useFolder),this._render({action:t.url.send,method:"post",enctype:"multipart/form-data",target:a?"":t.formTarget})},_render:function(t){var e=this._uploader,i=e.$container.find(":file"),n=s(this._html.FORM).append(e.$container.children()).attr(t);this.$el=n,this.$fileInput=i,this._setFileInput(),e.isBatchTransfer&&(this.$submit=e.$container.find(":submit")),e.isCrossDomain&&!a&&this._setHiddenInputForCORS(),e.$container.append(this.$el),this._addEvent()},_setHiddenInputForCORS:function(){var t,e,i=this._uploader,n=i.redirectURL;i.isSupportPostMessage?t={name:"messageTarget",value:location.protocol+"//"+location.host}:n&&(t={name:"redirectURL",value:n}),t&&(e=s(r.template(t,this._html.HIDDEN_INPUT)),e.appendTo(this.$el))},_setTemplate:function(t){return n.extend({},o.html,t)},_setFileInput:function(){var t=this._isMultiple,e=this._useFolder;this.$fileInput.attr("multiple",t),this.$fileInput.prop({multiple:t,directory:e,mozdirectory:e,webkitdirectory:e})},_addEvent:function(){this._uploader.isBatchTransfer&&this.$el.on("submit",s.proxy(this.fire,this,"submit")),this._addInputEvent()},_addInputEvent:function(){this.$fileInput.on("change",s.proxy(this.onChange,this))},onChange:function(){this.$fileInput[0].value&&this.fire("change")},resetFileInput:function(){var t=s(this.$fileInput[0].outerHTML);this.$fileInput.after(t),this.$fileInput.remove(),this.$fileInput=t,n.hasStamp(this.$fileInput[0])&&delete this.$fileInput[0][l],this._addInputEvent()},clear:function(){this.$el.find("."+h).remove(),this.resetFileInput()}});n.CustomEvents.mixin(c),t.exports=c},function(t,e,i){"use strict";var s=i(3),n=i(2),o=i(1),r=i(4),a=o.className,h=o.html,l=n.defineClass({init:function(t,e,i){this.$el=null,this.$checkbox=null,this.$removeButton=null,this.name=e.name,this.id=e.id,this.size=e.size||"",this.type=this._extractExtension(),this.template=i,this._render(t)},_render:function(t){var e=this._getHTML();this.$el=s(e).appendTo(t),this.$checkbox=this.$el.find(":checkbox"),this.$removeButton=this.$el.find("button"),this._addEvent()},_getHTML:function(){var t=this.template,e={filetype:this.type,filename:this.name,filesize:this.size?r.getFileSizeWithUnit(this.size):"",checkbox:h.CHECKBOX,removeButton:h.REMOVE_BUTTON};return r.template(e,t)},_extractExtension:function(){return this.name.split(".").pop()},_addEvent:function(){this.$checkbox.on("change",s.proxy(this._onChange,this)),this.$removeButton.on("click",s.proxy(this._onClickEvent,this))},_onChange:function(){var t=!!this.$checkbox.prop("checked");this._changeCheckbox(t),this.fire("check",{id:this.id,name:this.name,size:this.size,state:t})},_onClickEvent:function(){var t={};t[this.id]=!0,this.fire("remove",t)},_changeCheckbox:function(t){var e=this.$checkbox,i=r.getLabelElement(e),s=i?i:e,n=a.IS_CHECKED;t?s.addClass(n):s.removeClass(n)},changeCheckboxState:function(t){this.$checkbox.prop("checked",t),this._changeCheckbox(t)},getCheckedState:function(){return this.$checkbox.prop("checked")},destroy:function(){this.$el.remove()}});n.CustomEvents.mixin(l),t.exports=l},function(t,e,i){"use strict";var s=i(3),n=i(2),o=i(4),r=i(11),a=i(1),h=a.className,l=n.forEach,c=n.isUndefined,u=n.isArraySafe,d=n.defineClass({init:function(t,e){this.$el=t,this.$list=null,this.$checkbox=null,this.listType=e.type,this.item=e.item,this.columnList=e.columnList,this.itemTemplate=null,this.items=[],this._render(),this._addEvent()},_render:function(){var t="table"===this.listType,e=this._getListContainer(t);this.$el.append(e),t?(this._setTableWidth(e),this._setColumnGroup(),this._setTableHeader(),this._setTableRowTemplate()):this._setListItemTemplate(),this.$list=this.$el.find("."+h.LIST_ITEMS_CONTAINER),this.$checkbox=this.$el.find(":checkbox")},_addEvent:function(){this.$checkbox&&this.$checkbox.on("change",s.proxy(this._onChange,this))},_onChange:function(){var t=!!this.$checkbox.prop("checked");this._changeCheckboxInItem(t),this._changeCheckboxInHeader(t),this.fire("checkAll",{filelist:this.getCheckedItems()})},_getListContainer:function(t){var e=t?a.tableTemplate:a.listTemplate;return s(o.template({listItemsClassName:h.LIST_ITEMS_CONTAINER,checkbox:a.html.CHECKBOX},e.CONTAINER))},_setTableWidth:function(t){var e=this.columnList,i=parseInt(t.width(),10),s=0,n=0;l(e,function(t){t.width?s+=t.width:n+=1}),e&&this._setEmptyWidth(i-s,n)},_setEmptyWidth:function(t,e){var i=this.columnList,s=Math.floor(t/e),n=s+t%e;l(i,function(t,e){t.width||(t.width=i.length-1===e?n:s)})},_setColumnGroup:function(){var t=this.$el.find("colgroup"),e=this.columnList,i="";l(e,function(t){i+='<col width="'+t.width+'">'}),e&&t.html(i)},_setTableHeader:function(){var t=this.columnList,e="",i=0;l(t,function(t){c(t.header)||(e+='<th scope="col" width="'+t.width+'">'+t.header+"</th>",i+=1)}),t&&this._setHeaderElement(e,i===t.length)},_setHeaderElement:function(t,e){var i=this.$el.find("thead");e?(t=o.template({checkbox:a.html.CHECKBOX},t),i.html("<tr>"+t+"</tr>"),i.find("th").first().css("border-right",0),i.find("th").last().css("border-right",0)):i.hide()},_setTableRowTemplate:function(){var t=this.columnList,e="";l(t,function(t){e+='<td width="'+t.width+'">'+t.body+"</td>"}),e=e?"<tr>"+e+"</tr>":a.tableTemplate.LIST_ITEM,this.itemTemplate=e},_setListItemTemplate:function(){var t,e=this.item;t=e?"<li>"+e+"</li>":a.listTemplate.LIST_ITEM,this.itemTemplate=t},_setHasItemsClassName:function(){var t=h.HAS_ITEMS,e=!!this.items.length;e?this.$el.addClass(t):this.$el.removeClass(t)},_setLastColumnWidth:function(){var t=this.$el.find("th").last()[0].width,e=this.$list.width()-this.$list[0].scrollWidth,i=t-e;l(this.items,function(t){t.$el.find("td").last().attr("width",i)})},_addFileItems:function(t){u(t)||(t=[t]),l(t,function(t){this.items.push(this._createItem(t))},this)},_removeFileItems:function(t){var e;this.items=n.filter(this.items,function(i){return e=t[i.id],e&&i.destroy(),!e},this)},_createItem:function(t){var e=new r(this.$list,t,this.itemTemplate);return e.on("remove",this._onRemove,this),e.on("check",this._onCheck,this),e},_onRemove:function(t){this.fire("remove",t)},_onCheck:function(t){this._setCheckedAll(),this.fire("check",t)},_setCheckedAll:function(){var t=this.getCheckedItems(),e=t.length===this.items.length&&!!this.items.length;this.$checkbox.prop("checked",e),this._changeCheckboxInHeader(e)},_changeCheckboxInHeader:function(t){var e=this.$checkbox,i=o.getLabelElement(e),s=i?i:e,n=h.IS_CHECKED;t?s.addClass(n):s.removeClass(n)},_changeCheckboxInItem:function(t){l(this.items,function(e){e.changeCheckboxState(t)})},getCheckedItems:function(){var t=[];return n.forEach(this.items,function(e){e.getCheckedState()&&t.push({id:e.id,name:e.name,size:e.size})}),t},update:function(t,e){"remove"===e?this._removeFileItems(t):this._addFileItems(t),"table"===this.listType&&(this._setHasItemsClassName(),this._setCheckedAll(),this._setLastColumnWidth())},clear:function(){l(this.items,function(t){t.destroy()}),this.items.length=0,this._setHasItemsClassName(),this._setCheckedAll()}});n.CustomEvents.mixin(d),t.exports=d},function(t,e){}])});